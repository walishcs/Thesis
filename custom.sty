\usepackage[linguistics]{forest}
\usepackage[utf8]{inputenc}
\usepackage{libertine}
\usepackage{libertinust1math}
\usepackage[utf8]{inputenc}
\usepackage{xeCJK}
\setCJKmainfont{AR PL UKai TW}
\setCJKmonofont{AR PL UKai TW}
\setCJKsansfont{Noto Serif CJK TC}
\usepackage{pdfpages}
\usepackage{pdflscape}
\usepackage{subfiles} % 引入子文件
\usepackage{hyperref}
\hypersetup{hidelinks}
%\hypersetup{breaklinks=true}

%%% Customization  %%%
\usepackage{acro}
\acsetup{make-links}
\usepackage{longtable}
\usepackage{abbr} % 縮寫
\usepackage{zhlipsum, lipsum}   % dummy text
\usepackage{graphicx}           % figures
\usepackage{float}
\usepackage{enumitem}
\usepackage{booktabs}           % tables
\usepackage{multirow}
\usepackage{array}
\usepackage{makecell}
\usepackage{arydshln}
\usepackage{gb4e} %Glossing 用
\noautomath %防止gb4e爆掉
\usepackage[normalem]{ulem}
\useunder{\uline}{\ul}{}
\usepackage{multicol}
\usepackage{caption} 
\captionsetup[table]{skip=10pt} %表格caption間距
\setlength{\intextsep}{30pt plus 2pt minus 2pt} % 文本中的浮動體上下間距
\setlength{\textfloatsep}{20pt plus 2pt minus 4pt} % 頁面頂部或底部浮動體與文本之間的間距
\usepackage{chngpage} % allows for temporary adjustment of side margins
%\usepackage{cite}               % bibliography
\usepackage{xcolor} 
\usepackage{filecontents} %加入參考文獻說明


% 以下是在圖表目錄加上前綴 %
\usepackage{tocloft} %TOC裡的Table Figure
% for figures
\renewcommand{\cftfigpresnum}{Figure } % put before the number
%\renewcommand{\cftfigaftersnum}{: }  % put after the number
% adjust spacing
\newlength{\mylen}
\settowidth{\mylen}{\cftfigpresnum}
\addtolength{\cftfignumwidth}{\mylen}
% for tables
\renewcommand{\cfttabpresnum}{Table } % put before the number
%\renewcommand{\cfttabaftersnum}{: }  % put after the number
% adjust spacing
\newlength{\mylentwo}
\settowidth{\mylentwo}{\cfttabpresnum}
\addtolength{\cfttabnumwidth}{\mylentwo}


% 自訂指令 %
\newcommand{\xb}[1]{\textsubscript{#1}}
\newcommand{\aikai}[1]{\textcolor{red}{\textbf{#1}}}

% subsubsection 以下層級 %
\usepackage{titlesec}

\titleclass{\subsubsubsection}{straight}[\subsection]

\newcounter{subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}
\renewcommand\theparagraph{\thesubsubsubsection.\arabic{paragraph}} % optional; useful if paragraphs are to be numbered

\titleformat{\subsubsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{5}{\z@}%
  {3.25ex \@plus1ex \@minus.2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{6}{\parindent}%
  {3.25ex \@plus1ex \@minus .2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\def\toclevel@subsubsubsection{4}
\def\toclevel@paragraph{5}
\def\toclevel@paragraph{6}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
\def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
\def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
\makeatother

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{3}
% subsubsection 以下層級 %

% Bibliography

\usepackage[backend=biber, style=authoryear-comp, dashed=false, maxcitenames=2, maxbibnames=99]{biblatex}

%\defbibnote{bib-intro}{\textsf{\lipsum[1]}}

\setcounter{biburllcpenalty}{100}
\setcounter{biburlucpenalty}{200}
\setcounter{biburlnumpenalty}{100}


\addbibresource{ref.bib} %Import the bibliography file
\renewcommand*{\nameyeardelim}{\space}
\renewcommand*{\postnotedelim}{\addcolon\space}
\renewcommand*{\bibpagespunct}{\addcolon\space}
\DefineBibliographyStrings{english}{%
  page             = {},
  pages            = {},
} 
%\renewcommand*{\bibfont}{\footnotesize}

\newcommand{\sameyear}[1]{}

\usepackage{xpatch}
\AtEveryBibitem{\clearfield{month}}
\AtEveryCitekey{\clearfield{month}}
\xpatchbibmacro{date+extradate}{%
  \printtext[parens]%
}{%
  \setunit{\addperiod\space}%
  \printtext%
}{}{}

\NewBibliographyString{toappear}
\DefineBibliographyStrings{english}{%
  toappear = {to appear},
}

%Add comma between two authors in bibliography only
\AtBeginBibliography{\renewcommand*{\finalnamedelim}{
  \finalandcomma
  \addspace\bibstring{and}\space}  
 }

\DeclareFieldFormat[article,inproceedings,misc,inbook,incollection]{citetitle}{#1}
\DeclareFieldFormat[article,inproceedings,misc,inbook,incollection]{title}{#1}
\DeclareFieldFormat[thesis]{title}{\mkbibemph{#1}}
\DeclareFieldFormat[article,book,inproceedings,misc,inbook,incollection,thesis]{addendum}{#1\nopunct}
\DeclareFieldFormat[article,inproceedings,misc,inbook,incollection,thesis]{volume}{#1}
\renewbibmacro{in:}{}

\DefineBibliographyStrings{american}{phdthesis = {PhD dissertation}}
\urlstyle{same}


%%END Bibliography Setup%%